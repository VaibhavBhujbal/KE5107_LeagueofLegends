---
title: "League of Legends"
output: html_document
---

```{r echo=FALSE, message=FALSE, warning=FALSE, "0.1 packages"}

library(ggplot2)
library(bitops)
library(tidyr)
library(RCurl)
library(ggthemes)
library(foreign)
library(grid)
library(RColorBrewer)
library(gridExtra)
library(reshape2)
library(stringr)
library(scales)
library(dplyr)
library(GGally)
library(memisc)
library(lattice)
library(MASS)
```

```{r "0.2 Load_the_Data"}
# Source: https://www.kaggle.com/chuckephron/leagueoflegends
getwd()

# Tip: don't run seperately with load command.
# PC:
# setwd('C:/Users/Gebruiker 1/Dropbox/NUS/Data mining/leagueoflegends')
# laptop:
setwd('C:/Users/User/Dropbox/NUS/Data mining/leagueoflegends')

# load data file
matches <- read.csv("matches.csv", header=TRUE, sep=",")
```
```{r echo=FALSE, message=FALSE, warning=FALSE, "0.3 Functions"}
substrRight <- function(x, n){
  substr(x, nchar(x)-n+1, nchar(x))
}

cuberoot_trans = function() trans_new('cuberoot', 
                                      transform = function(x) x^(1/3), 
                                      inverse = function(x) X^3)



# Problem: appending to an object in a for loop causes the entire object to be copied on every iteration --> very slow.

create_column_names <- function(columns){
  maxnr <- max(matches$columns)
  vectofnr = c();
  for (i in 1:81){
    # print(i)
    vectofnr[i] <- paste("gold diff in minute", as.character(i))
    # print(vectofnr)
  }
  return(vectofnr)
}
# because it is so slow, maybe we can also put it in a global var:
listofcolumns <- create_column_names(gamelength)

# nrofcolumn <- function(nrsofcolumn){
#   while(nrofcolumn > 0){
#     print(nrofcolumn);
#     listofnr = c();
#     listofnr <- as.character(nrofcolumn);
#     print(listofnr);
#     nrofcolumn <- nrofcolumn-1
#   }
#   return(listofnr)
# }
# 
# nrofcolumn(3)

```


```{r echo=FALSE, message=FALSE, warning=FALSE, results = "hide", "0.4 Data Wrangling"}

## 0.4.0 explore a bit

# Get the names
names(matches)
# this runs a whole summary
# summary(matches)
summary(matches$bResult)
# ---> so blue wins more


# 0.4.1 viewing & correcting types
str(matches)
# So there are 185 teams --> seems like a lot? Do teams change from name?

## 0.4.2 making interpretation (and graphs) more easy by adding winner (blue or red) column
matches$winner <- ifelse(matches$bResult > 0, c("blue"), c("red"))

## 0.4.3 making different columns out of each golddiff array with function

# get rid of [ & ]
matches$golddiff <- substring(matches$golddiff, 2, str_length(matches$golddiff)-1)

# It gets messy very easily so extra dataset
matches2 <- matches %>%
  separate(golddiff, into = c(create_column_names(gamelength)), sep = "\\,")

## 0.4.4 Square the data if scewed 


```
