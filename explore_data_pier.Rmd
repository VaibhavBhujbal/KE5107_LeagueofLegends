---
title: "explore_data_pier"
author: "pier"
date: "10/02/2018"
output:
  html_document:
    keep_md: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r load_data}
rm(list=ls()) # cleanup
matches <- read.csv("/Users/pierlim/R_Projects/League_Of_Legends/matches.csv")
bluewin <- subset(matches, matches$bResult==1)
redwin <- subset(matches, matches$rResult==1)
```

**See blue top winning teams ** 

```{r top_winning_blue_teams, echo=FALSE}
t <- table(bluewin$blueTeamTag)
t_sorted = sort(t, decreasing=TRUE)[1:10] # sorts and gets top 10
t_sorted_df = data.frame(t_sorted)
names(t_sorted_df)[names(t_sorted_df) == 'Var1'] <- 'Team'
ggplot(t_sorted_df, aes(x=Team,y=Freq)) +geom_bar(stat = "identity")
```

See top winning red teams.

```{r top_winning_red_teams, echo=FALSE}
t <- table(redwin$redTeamTag)
t_sorted = sort(t, decreasing=TRUE)[1:10] # sorts and gets top 10
t_sorted_df = data.frame(t_sorted)
names(t_sorted_df)[names(t_sorted_df) == 'Var1'] <- 'Team'
ggplot(t_sorted_df, aes(x=Team,y=Freq)) +geom_bar(stat = "identity")
```

Okay, Blue Team SKT clearly has the most wins, regardless of whether they are blue or red. 
Let's take out all the games where SKT won, and analyze this particular team to see what is their magic. 

** Analyzing the Top Team ** 

```{r analyze_top_team, echo=FALSE}

library(plyr)

blue_skt_wins <- subset(bluewin, bluewin$blueTeamTag=="SKT")
red_skt_wins <- subset(redwin, redwin$redTeamTag=="SKT")

# Function to combine positions for blue skt and red skt wins
plotTopPlayersForPositionCombined <- function(dataset1, col_name1, dataset2, col_name2, titleStr){
  t1 <- table(dataset1[[col_name1]])
  t1_sorted = sort(t1, decreasing=TRUE)[1:10]
  t1_sorted_df = data.frame(t1_sorted)
  t2 <- table(dataset2[[col_name2]])
  t2_sorted = sort(t2, decreasing=TRUE)[1:10]
  t2_sorted_df = data.frame(t2_sorted)
  print(t1_sorted_df)
  names(t2_sorted_df)[names(t2_sorted_df) == 'Freq'] <- 'Freq2'
  print(t2_sorted_df)
  new_df <- merge(t1_sorted_df, t2_sorted_df, all.x=TRUE)
  new_df <- ddply(new_df, .(Var1, Freq, Freq2), summarise, Total=sum(Freq, Freq2))
  names(new_df)[names(new_df) == 'Var1'] <- 'Player'
  ggplot(new_df, aes(x=Player,y=Total)) +geom_histogram(stat = "identity")+ggtitle(titleStr) + theme(plot.title = element_text(hjust = 0.5))
}

plotTopPlayersForPositionCombined(blue_skt_wins, 'blueTop', red_skt_wins, 'redTop', "Top Position")
plotTopPlayersForPositionCombined(blue_skt_wins, 'blueADC', red_skt_wins, 'redADC', "ADC Position")
plotTopPlayersForPositionCombined(blue_skt_wins, 'blueJungle', red_skt_wins, 'redJungle', "Jungle Position")
plotTopPlayersForPositionCombined(blue_skt_wins, 'blueSupport', red_skt_wins, 'redSupport', "Support Position")
plotTopPlayersForPositionCombined(blue_skt_wins, 'blueMiddle', red_skt_wins, 'redMiddle', "Middle Position")
# plotTopPlayersForPosition(blue_skt_wins, 'blueTop')
# plotTopPlayersForPosition(blue_skt_wins, 'blueADC')
# plotTopPlayersForPosition(blue_skt_wins, 'blueJungle')
# plotTopPlayersForPosition(blue_skt_wins, 'blueSupport')
# plotTopPlayersForPosition(blue_skt_wins, 'blueMiddle')
# 
# plotTopPlayersForPosition(red_skt_wins, 'redTop')
# plotTopPlayersForPosition(red_skt_wins, 'redADC')
# plotTopPlayersForPosition(red_skt_wins, 'redJungle')
# plotTopPlayersForPosition(red_skt_wins, 'redSupport')
# plotTopPlayersForPosition(red_skt_wins, 'redMiddle')

```

It's very interesting - it's not so much the champions, but the players themselves play the same position almost all of the time! They are highly specialized.

For SKT team, the most frequent player at each position is:

MaRin/Duke at Top position
Bang at ADC position (Bang is the only one who sometimes plays at Jungle position)
Bengi/Blank/Peanut at Jungle position
Wolf at Support position
Faker at Middle position

We can go one step further to see which are the most frequent combos based on this data, if required. 


```{r}

plotTopChampionsForPositionCombined <- function(dataset1, col_name1, dataset2, col_name2, titleStr){
  t1 <- table(dataset1[[col_name1]])
  t1_sorted = sort(t1, decreasing=TRUE)[1:10]
  t1_sorted_df = data.frame(t1_sorted)
  t2 <- table(dataset2[[col_name2]])
  t2_sorted = sort(t2, decreasing=TRUE)[1:10]
  t2_sorted_df = data.frame(t2_sorted)
  names(t2_sorted_df)[names(t2_sorted_df) == 'Freq'] <- 'Freq2'
  new_df <- merge(t1_sorted_df, t2_sorted_df, all.x=TRUE)
  print(new_df)
  names(new_df)[names(new_df) == 'Var1'] <- 'Player'
  new_df <- ddply(new_df, .(Player, Freq, Freq2), summarise, Total=sum(Freq, Freq2))
  new_df <- new_df[complete.cases(new_df), ] # remove NA
  new_df <- new_df[with(new_df, order(-Total)),]

  ggplot(new_df, aes(x=Player,y=Total)) +geom_histogram(stat = "identity")+ggtitle(titleStr) + theme(plot.title = element_text(hjust = 0.5))
}

plotTopChampionsForPositionCombined(blue_skt_wins, 'blueTopChamp', red_skt_wins, 'redTopChamp', "Top Position")
plotTopChampionsForPositionCombined(blue_skt_wins, 'blueADCChamp', red_skt_wins, 'redADCChamp', "ADC Position")
plotTopChampionsForPositionCombined(blue_skt_wins, 'blueJungleChamp', red_skt_wins, 'redJungleChamp', "Jungle Position")
plotTopChampionsForPositionCombined(blue_skt_wins, 'blueSupportChamp', red_skt_wins, 'redSupportChamp', "Support Position")
plotTopChampionsForPositionCombined(blue_skt_wins, 'blueMiddleChamp', red_skt_wins, 'redMiddleChamp', "Middle Position")

# blue_top_champs <- plotTopPlayersForPosition(blue_skt_wins, 'blueTopChamp')
# red_top_champs <- plotTopPlayersForPosition(red_skt_wins, 'redTopChamp')
# names(red_top_champs)[names(red_top_champs) == 'Freq'] <- 'Freq2'
# new_df <- merge(blue_top_champs, red_top_champs, all.x=TRUE)
# new_df <- ddply(new_df, .(Player, Freq, Freq2), summarise, Total=sum(Freq, Freq2))
# new_df <- new_df[complete.cases(new_df), ] # remove NA
# new_df <- new_df[with(new_df, order(-Total)),]

# # Function to combine positions for blue skt and red skt wins
# plotTopPlayersForPositionCombined <- function(dataset1, col_name1, dataset2, col_name2, titleStr){
#   t1 <- table(dataset1[[col_name1]])
#   t1_sorted = sort(t1, decreasing=TRUE)[1:10]
#   t1_sorted_df = data.frame(t1_sorted)
#   t2 <- table(dataset2[[col_name2]])
#   t2_sorted = sort(t2, decreasing=TRUE)[1:10]
#   t2_sorted_df = data.frame(t2_sorted)
#   print(t1_sorted_df)
#   names(t2_sorted_df)[names(t2_sorted_df) == 'Freq'] <- 'Freq2'
#   print(t2_sorted_df)
#   new_df <- merge(t1_sorted_df, t2_sorted_df, all.x=TRUE)
#   new_df <- ddply(new_df, .(Var1, Freq, Freq2), summarise, Total=sum(Freq, Freq2))
#   names(new_df)[names(new_df) == 'Var1'] <- 'Player'
#   ggplot(new_df, aes(x=Player,y=Total)) +geom_histogram(stat = "identity")+ggtitle(titleStr) + theme(plot.title = element_text(hjust = 0.5))
# }
# 
# plotTopPlayersForPositionCombined(blue_skt_wins, 'blueTopChamp', red_skt_wins, 'redTopChamp', "Top Position")
# plotTopPlayersForPositionCombined(blue_skt_wins, 'blueADCChamp', red_skt_wins, 'redADCChamp', "ADC Position")
# plotTopPlayersForPositionCombined(blue_skt_wins, 'blueJungleChamp', red_skt_wins, 'redJungleChamp', "Jungle Position")
# plotTopPlayersForPositionCombined(blue_skt_wins, 'blueSupportChamp', red_skt_wins, 'redSupportChamp', "Support Position")
# plotTopPlayersForPositionCombined(blue_skt_wins, 'blueMiddleChamp', red_skt_wins, 'redMiddleChamp', "Middle Position")
```

For Champions, there definitely are favourite champions for each position, but as you can see it is more varied. 


